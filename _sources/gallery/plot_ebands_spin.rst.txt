.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_gallery_plot_ebands_spin.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_plot_ebands_spin.py:


Spin-polarized e-bands
======================

This example shows how to plot the band structure of nickel
using the eigenvalues stored in the GSR file produced at the end of the GS run.



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /gallery/images/sphx_glr_plot_ebands_spin_001.png
            :class: sphx-glr-multi-img

    *

      .. image:: /gallery/images/sphx_glr_plot_ebands_spin_002.png
            :class: sphx-glr-multi-img

    *

      .. image:: /gallery/images/sphx_glr_plot_ebands_spin_003.png
            :class: sphx-glr-multi-img

    *

      .. image:: /gallery/images/sphx_glr_plot_ebands_spin_004.png
            :class: sphx-glr-multi-img

    *

      .. image:: /gallery/images/sphx_glr_plot_ebands_spin_005.png
            :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /Users/gmatteo/git_repos/pymatgen/pymatgen/util/plotting.py:550: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
      plt.show()
    /Users/gmatteo/git_repos/pymatgen/pymatgen/util/plotting.py:550: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
      plt.show()
    /Users/gmatteo/git_repos/pymatgen/pymatgen/util/plotting.py:550: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
      plt.show()
    /Users/gmatteo/git_repos/pymatgen/pymatgen/util/plotting.py:550: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
      plt.show()
    /Users/gmatteo/git_repos/pymatgen/pymatgen/util/plotting.py:550: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
      plt.show()





|


.. code-block:: default

    from abipy import abilab
    import abipy.data as abidata

    # Open the GSR file and extract the band structure.
    # (alternatively one can use the shell and `abiopen.py OUT_GSR.nc -nb`
    # to open the file in a jupyter notebook.
    with abilab.abiopen(abidata.ref_file("ni_666k_GSR.nc")) as ncfile:
        ni_ebands_kmesh = ncfile.ebands

    with abilab.abiopen(abidata.ref_file("ni_kpath_GSR.nc")) as ncfile:
        ni_ebands_kpath = ncfile.ebands

    # Energy limits in eV for plots. The pseudo contains semi-core states but
    # we are not interested in this energy region. Fermi level set to zero.
    elims = [-10, 2]

    # Plot band energies on k-path
    ni_ebands_kpath.plot(ylims=elims, title="Ni band structure")

    # Compute DOS with Gaussian method.
    ni_edos = ni_ebands_kmesh.get_edos()

    # Plot energies on k-path + DOS
    ni_ebands_kpath.plot_with_edos(ni_edos, ylims=elims,
                                   title="Ni band structure + DOS")

    # Plot electronic DOS.
    #ni_edos.plot_dos_idos(xlims=elims)
    #ni_edos.plot(xlims=elims)
    #ni_edos.plot_up_minus_down(xlims=elims)


    # Boxplot for 10 > band >= 5
    ni_ebands_kpath.boxplot(brange=[5, 10],
                            title="Boxplot for up and down spin and 10 > band >= 5")


    # Use ElectronBandsPlotter to analyze multiple ElectronBands object
    plotter = abilab.ElectronBandsPlotter()
    plotter.add_ebands("k-mesh", ni_ebands_kmesh)
    plotter.add_ebands("k-path", ni_ebands_kpath)

    ylims = [-10, 5]
    #plotter.combiplot(ylims=ylims)
    plotter.gridplot(ylims=ylims)
    #plotter.boxplot(brange=[5, 10])
    plotter.combiboxplot(brange=[5, 10])


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  2.264 seconds)


.. _sphx_glr_download_gallery_plot_ebands_spin.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_ebands_spin.py <plot_ebands_spin.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_ebands_spin.ipynb <plot_ebands_spin.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
